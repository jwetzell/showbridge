{
  "$schema": "./schema/config.schema.json",
  "http": {
    "params": {
      "port": 3000
    },
    "triggers": [
      {
        "type": "regex",
        "params": {
          "patterns": ["^/midi/note_on$"],
          "properties": ["originalUrl"]
        },
        "actions": [{ "type": "log", "enabled": true }],
        "enabled": true
      }
    ]
  },
  "ws": {
    "triggers": []
  },
  "osc": {
    "params": {
      "tcpPort": 8000,
      "udpPort": 8000
    },
    "triggers": [
      {
        "type": "regex",
        "params": {
          "patterns": ["^.*$"],
          "properties": ["address"]
        },
        "actions": [
          {
            "type": "osc-output",
            "params": {
              "_address": "${msg.address}/${Math.floor(( msg.args[0] - 0 ) * ( 100 - 0 ) / ( 10 - 0 ) + 0)}",
              "_args": ["${msg.args[0]}"],
              "host": "localhost",
              "port": 8001,
              "protocol": "udp"
            },
            "enabled": true
          },
          {
            "type": "osc-forward",
            "params": {
              "host": "localhost",
              "port": 8001,
              "protocol": "udp"
            },
            "enabled": true
          },
          {
            "type": "log",
            "enabled": true
          }
        ],
        "enabled": true
      }
    ]
  },
  "midi": {
    "triggers": [
      {
        "type": "regex",
        "params": {
          "patterns": ["note_on"],
          "properties": ["status"]
        },
        "enabled": true,
        "actions": [
          {
            "type": "log",
            "enabled": true
          },
          {
            "type": "http",
            "params": {
              "method": "POST",
              "_url": "http://localhost:3000/midi/${msg.status}",
              "_body": "{\"note\":${msg.note}}",
              "contentType": "json"
            },
            "enabled": true
          },
          {
            "type": "midi-output",
            "params": {
              "data": [144, 60, 100]
            },
            "enabled": true
          }
        ]
      }
    ]
  }
}
